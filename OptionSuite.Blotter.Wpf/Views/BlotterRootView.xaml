<UserControl x:Class="OptionSuite.Blotter.Wpf.Views.BlotterRootView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <UserControl.Resources>

        <!-- =========================================================
             SOFT FOG (token-baserad)
             Bygger “dimmad” top-to-bottom känsla över hela contentytan.
             Endast tokens: Panel/Panel2/BorderSoft/Glow.Accent/Transparent.
             ========================================================= -->
        <LinearGradientBrush x:Key="Blotter.Brush.ContentFog" StartPoint="0,0" EndPoint="0,1">
            <!-- Lite ljusare uppe -->
            <GradientStop Color="{StaticResource Color.BorderSoft}" Offset="0.0"/>
            <!-- Dimmad blå ton -->
            <GradientStop Color="{StaticResource Color.Glow.Accent}" Offset="0.35"/>
            <!-- Ner mot panel -->
            <GradientStop Color="{StaticResource Color.Transparent}" Offset="1.0"/>
        </LinearGradientBrush>

        <!-- =========================================================
             Status-/filterstrip (kvar – ingen funktionalitet ändras)
             ========================================================= -->
        <Style x:Key="BlotterStripButtonBaseStyle" TargetType="Button">
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="Margin" Value="0,0,8,0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{StaticResource Brush.BorderSoft}"/>
            <Setter Property="Background" Value="{StaticResource Brush.Panel}"/>
            <Setter Property="Foreground" Value="{StaticResource Brush.TextMuted}"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="{StaticResource Radius.Button}">
                            <ContentPresenter Margin="{TemplateBinding Padding}"
                                              VerticalAlignment="Center"
                                              HorizontalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="BlotterStripButtonActiveStyle"
               TargetType="Button"
               BasedOn="{StaticResource BlotterStripButtonBaseStyle}">
            <Setter Property="Foreground" Value="{StaticResource Brush.Text}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Brush.Border}"/>
            <Setter Property="Background" Value="{StaticResource Brush.Panel2}"/>
        </Style>

        <Style x:Key="BlotterStripCountBadgeStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource Brush.Panel2}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Brush.BorderSoft}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="{StaticResource Radius.Button}"/>
            <Setter Property="Padding" Value="8,1"/>
            <Setter Property="Margin" Value="8,0,0,0"/>
        </Style>

        <Style x:Key="BlotterStripCountTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="{StaticResource Brush.TextMuted}"/>
        </Style>

        <!-- Combined Status + New badge - med Grid för alignment -->
        <DataTemplate x:Key="StatusPillTemplate">
            <Grid HorizontalAlignment="Left">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <!-- Status pill -->
                    <ColumnDefinition Width="8"/>
                    <!-- Margin -->
                    <ColumnDefinition Width="Auto"/>
                    <!-- New badge -->
                </Grid.ColumnDefinitions>

                <!-- Status pill -->
                <Border Grid.Column="0"
                BorderBrush="{StaticResource Brush.BorderSoft}"
                BorderThickness="1"
                Background="{StaticResource Blotter.Brush.GlassPill}"
                CornerRadius="{StaticResource Radius.Button}"
                Padding="10,3"
                MinWidth="80">
                    <!-- Minsta bredd så alla status får samma space -->
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <Ellipse Width="7" Height="7" Margin="0,0,8,0" VerticalAlignment="Center">
                            <Ellipse.Style>
                                <Style TargetType="Ellipse">
                                    <Setter Property="Fill" Value="{StaticResource Brush.TextMuted}"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Status}" Value="New">
                                            <Setter Property="Fill" Value="#3B82F6"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Status}" Value="Booked">
                                            <Setter Property="Fill" Value="#2DD4BF"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Status}" Value="Pending">
                                            <Setter Property="Fill" Value="#FBBF24"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Status}" Value="Rejected">
                                            <Setter Property="Fill" Value="#FB7185"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Ellipse.Style>
                        </Ellipse>

                        <TextBlock Text="{Binding Status}"
                           Foreground="{StaticResource Brush.Text}"
                           FontSize="12"
                           VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- New badge (Grid.Column="2" så den hamnar efter marginal) -->
                <Border Grid.Column="2"
                Style="{StaticResource NewBadgeBorderStyle}"
                VerticalAlignment="Center"
                Visibility="{Binding IsNew, Converter={StaticResource BoolToVisConverter}}">
                    <TextBlock Text="New" Style="{StaticResource NewBadgeTextStyle}"/>
                </Border>

            </Grid>
        </DataTemplate>




        <!-- =========================================================
             Detail tabs (högerpanelen) – oförändrat
             ========================================================= -->
        <Style x:Key="DetailTabButtonBaseStyle" TargetType="Button">
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="Margin" Value="0,0,6,0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource Brush.TextMuted}"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="{StaticResource Radius.Button}">
                            <ContentPresenter Margin="{TemplateBinding Padding}"
                                              VerticalAlignment="Center"
                                              HorizontalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="DetailTabButtonActiveStyle"
               TargetType="Button"
               BasedOn="{StaticResource DetailTabButtonBaseStyle}">
            <Setter Property="Foreground" Value="{StaticResource Brush.Text}"/>
            <Setter Property="Background" Value="{StaticResource Brush.Panel2}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Brush.BorderSoft}"/>
        </Style>

    </UserControl.Resources>

    <Grid Margin="{StaticResource Thickness.WindowPadding}">

        <Border Background="{StaticResource Brush.Panel}"
                BorderBrush="{StaticResource Brush.Border}"
                BorderThickness="1"
                CornerRadius="0">

            <Grid Margin="{StaticResource Thickness.WindowPadding}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Title -->
                <StackPanel Grid.Row="0">
                    <TextBlock Text="{Binding Title}"
                               FontSize="16"
                               FontWeight="SemiBold"
                               Foreground="{StaticResource Brush.Text}" />

                    <TextBlock Text="{Binding Subtitle}"
                               Margin="0,6,0,0"
                               FontSize="12"
                               Foreground="{StaticResource Brush.TextMuted}" />
                </StackPanel>

                <!-- Main area -->
                <Border Grid.Row="1"
                        Margin="0,14,0,0"
                        BorderBrush="{StaticResource Brush.BorderSoft}"
                        BorderThickness="1"
                        CornerRadius="{StaticResource Radius.Button}"
                        Background="{StaticResource Brush.Panel2}">

                    <!-- Gemensam “fog” över ALLT (toolbar + filter + grid + detail) -->
                    <Grid Background="{StaticResource Blotter.Brush.ContentFog}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- =========================================================
                             TOOLBAR + FILTER STRIP
                             Låt fog ligga under; använd bara separators.
                             ========================================================= -->
                        <Grid Grid.Row="0" Background="Transparent">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="1"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="1"/>
                            </Grid.RowDefinitions>

                            <!-- Toolbar -->
                            <Grid Grid.Row="0" Background="Transparent">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- Left actions -->
                                <StackPanel Orientation="Horizontal"
                                            Margin="12"
                                            VerticalAlignment="Center">

                                    <Button Style="{StaticResource Style.BlotterToolbarButton}">
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                            <TextBlock Text="▶"
                                                       Margin="0,0,8,0"
                                                       FontSize="11"
                                                       Foreground="{StaticResource Brush.TextMuted}"
                                                       VerticalAlignment="Center"/>
                                            <TextBlock Text="Book"
                                                       VerticalAlignment="Center"/>

                                            <Border Style="{StaticResource Style.BlotterShortcutPill}"
                                                    Margin="10,0,0,0">
                                                <TextBlock Style="{StaticResource Style.BlotterShortcutPillText}"
                                                           Text="Ctrl+B"/>
                                            </Border>
                                        </StackPanel>
                                    </Button>

                                    <Button Style="{StaticResource Style.BlotterToolbarButton}"
                                            Content="Refresh"
                                            Command="{Binding RefreshCommand}"
                                            Margin="10,0,0,0"/>


                                    <Button Style="{StaticResource Style.BlotterToolbarButton}"
                                            Content="Export"
                                            Margin="10,0,0,0"/>

                                    <Button Style="{StaticResource Style.BlotterToolbarButton}"
                                            Content="Clear filters"
                                            Margin="10,0,0,0"/>
                                </StackPanel>

                                <!-- Right tools -->
                                <StackPanel Grid.Column="1"
                                            Orientation="Horizontal"
                                            Margin="12"
                                            VerticalAlignment="Center">

                                    <!-- Search -->
                                    <Border CornerRadius="{StaticResource Radius.Button}"
                                            BorderBrush="{StaticResource Brush.Border}"
                                            BorderThickness="1"
                                            Background="{StaticResource Brush.PanelChromeTitle}"
                                            Padding="10,7"
                                            MinWidth="300">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Text="Search"
                                                       Foreground="{StaticResource Brush.TextMuted}"
                                                       VerticalAlignment="Center"/>

                                            <TextBox Grid.Column="1"
                                                     Margin="10,0"
                                                     Background="Transparent"
                                                     BorderThickness="0"
                                                     Foreground="{StaticResource Brush.Text}"
                                                     FontSize="12"
                                                     VerticalContentAlignment="Center"/>

                                            <Border Grid.Column="2"
                                                    CornerRadius="7"
                                                    BorderBrush="{StaticResource Brush.BorderSoft}"
                                                    BorderThickness="1"
                                                    Background="{StaticResource Brush.PanelChromeTitle}"
                                                    Padding="6,2"
                                                    VerticalAlignment="Center">
                                                <TextBlock Text="Ctrl+F"
                                                           FontFamily="{StaticResource Font.Mono}"
                                                           FontSize="11"
                                                           Foreground="{StaticResource Brush.TextMuted}"/>
                                            </Border>
                                        </Grid>
                                    </Border>

                                    <Button Style="{StaticResource Style.BlotterToolbarButton}"
                                            Content="Columns"
                                            Margin="10,0,0,0"/>

                                    <Button Style="{StaticResource Style.BlotterToolbarButton}"
                                            Content="Settings"
                                            Margin="10,0,0,0"/>
                                </StackPanel>
                            </Grid>

                            <!-- Separator toolbar -> filter -->
                            <Border Grid.Row="1" Background="{StaticResource Brush.Border}"/>

                            <!-- Filter strip -->
                            <Border Grid.Row="2" Background="Transparent">
                                <StackPanel Orientation="Horizontal" Margin="12,10">

                                    <RadioButton GroupName="BlotterStatusFilter"
                                                 Style="{StaticResource Style.BlotterStripToggle}"
                                                 IsChecked="True">
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                            <TextBlock Text="All" Style="{StaticResource Style.BlotterStripLabel}"/>
                                            <Border Style="{StaticResource Style.BlotterCountPill}" Margin="8,0,0,0">
                                                <TextBlock Text="128" Style="{StaticResource Style.BlotterCountPillText}"/>
                                            </Border>
                                        </StackPanel>
                                    </RadioButton>

                                    <RadioButton GroupName="BlotterStatusFilter"
                                                 Style="{StaticResource Style.BlotterStripToggle}"
                                                 Margin="6,0,0,0">
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                            <TextBlock Text="New" Style="{StaticResource Style.BlotterStripLabel}"/>
                                            <Border Style="{StaticResource Style.BlotterCountPill}" Margin="8,0,0,0">
                                                <TextBlock Text="5" Style="{StaticResource Style.BlotterCountPillText}"/>
                                            </Border>
                                        </StackPanel>
                                    </RadioButton>

                                    <RadioButton GroupName="BlotterStatusFilter"
                                                 Style="{StaticResource Style.BlotterStripToggle}"
                                                 Margin="6,0,0,0">
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                            <TextBlock Text="Booked" Style="{StaticResource Style.BlotterStripLabel}"/>
                                            <Border Style="{StaticResource Style.BlotterCountPill}" Margin="8,0,0,0">
                                                <TextBlock Text="94" Style="{StaticResource Style.BlotterCountPillText}"/>
                                            </Border>
                                        </StackPanel>
                                    </RadioButton>

                                    <RadioButton GroupName="BlotterStatusFilter"
                                                 Style="{StaticResource Style.BlotterStripToggle}"
                                                 Margin="6,0,0,0">
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                            <TextBlock Text="Rejected" Style="{StaticResource Style.BlotterStripLabel}"/>
                                            <Border Style="{StaticResource Style.BlotterCountPill}" Margin="8,0,0,0">
                                                <TextBlock Text="3" Style="{StaticResource Style.BlotterCountPillText}"/>
                                            </Border>
                                        </StackPanel>
                                    </RadioButton>

                                    <RadioButton GroupName="BlotterStatusFilter"
                                                 Style="{StaticResource Style.BlotterStripToggle}"
                                                 Margin="6,0,0,0">
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                            <TextBlock Text="Errors" Style="{StaticResource Style.BlotterStripLabel}"/>
                                            <Border Style="{StaticResource Style.BlotterCountPill}" Margin="8,0,0,0">
                                                <TextBlock Text="2" Style="{StaticResource Style.BlotterCountPillText}"/>
                                            </Border>
                                        </StackPanel>
                                    </RadioButton>

                                </StackPanel>
                            </Border>

                            <!-- Separator filter -> content -->
                            <Border Grid.Row="3" Background="{StaticResource Brush.Border}"/>
                        </Grid>

                        <!-- =========================================================
                             CONTENT (Grid + Detail)
                             Fog ligger under, så här håller vi ytor transparenta.
                             ========================================================= -->
                        <Grid Grid.Row="1" Background="Transparent">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="1"/>
                                <ColumnDefinition Width="360"/>
                            </Grid.ColumnDefinitions>

                            <!-- LEFT: DataGrid -->
                            <!-- Ersätt din nuvarande DataGrid med detta: -->

                            <Grid>
                                <Grid.RowDefinitions>
                                    <!-- Section header för options -->
                                    <RowDefinition Height="Auto"/>
                                    <!-- Options grid -->
                                    <RowDefinition Height="*"/>
                                    <!-- Gap mellan grids -->
                                    <RowDefinition Height="12"/>
                                    <!-- Section header för linear -->
                                    <RowDefinition Height="Auto"/>
                                    <!-- Linear grid -->
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- ==================== OPTIONS SECTION ==================== -->
                                <Border Grid.Row="0" Style="{StaticResource Style.BlotterSectionHeader}">
                                    <TextBlock Text="OPTIONS (VANILLA • NDO)" 
                   Style="{StaticResource Style.BlotterSectionHeaderText}"/>
                                </Border>

                                <!-- OPTIONS GRID - bind till SelectedOptionTrade -->
                                <DataGrid Grid.Row="1"
          Style="{StaticResource Style.BlotterDataGrid}"
          ItemsSource="{Binding OptionTrades}"
          SelectedItem="{Binding SelectedOptionTrade, Mode=TwoWay}"
          ColumnHeaderStyle="{StaticResource Style.BlotterDataGridHeader}"
          CellStyle="{StaticResource Style.BlotterDataGridCell}"
          RowStyle="{StaticResource Style.BlotterDataGridRow.Options}"
          AutoGenerateColumns="False">

                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="TradeID" Binding="{Binding TradeId}" Width="120"/>
                                        <DataGridTextColumn Header="Counterpart" Binding="{Binding Counterparty}" Width="100"/>
                                        <DataGridTextColumn Header="Ccy Pair" Binding="{Binding CcyPair}" Width="80"/>
                                        <DataGridTextColumn Header="Buy/Sell" Binding="{Binding BuySell}" Width="70"/>
                                        <DataGridTextColumn Header="Call/Put" Binding="{Binding CallPut}" Width="70"/>
                                        <DataGridTextColumn Header="Strike" Binding="{Binding Strike, StringFormat=F4}" Width="90"/>
                                        <DataGridTextColumn Header="Expiry Date" Binding="{Binding ExpiryDate, StringFormat=yyyy-MM-dd}" Width="100"/>
                                        <DataGridTextColumn Header="Notional" Binding="{Binding Notional, StringFormat=N0}" Width="110"/>
                                        <DataGridTextColumn Header="Notional Ccy" Binding="{Binding NotionalCcy}" Width="90"/>
                                        <DataGridTextColumn Header="Premium" Binding="{Binding Premium, StringFormat=N2}" Width="100"/>
                                        <DataGridTextColumn Header="Premium Ccy" Binding="{Binding PremiumCcy}" Width="90"/>
                                        <DataGridTextColumn Header="Portfolio MX3" Binding="{Binding PortfolioMx3}" Width="110"/>
                                        <DataGridTextColumn Header="Trader" Binding="{Binding Trader}" Width="80"/>
                                        <DataGridTemplateColumn Header="Status" Width="180" CellTemplate="{StaticResource StatusPillTemplate}" />
                                    </DataGrid.Columns>
                                </DataGrid>

 


                                <!-- ==================== LINEAR SECTION ==================== -->
                                <Border Grid.Row="3" Style="{StaticResource Style.BlotterSectionHeader}">
                                    <TextBlock Text="LINEAR (SPOT • FWD • SWAP • NDF)" 
                                               Style="{StaticResource Style.BlotterSectionHeaderText}"/>
                                </Border>

                                <DataGrid Grid.Row="4"
              Style="{StaticResource Style.BlotterDataGrid}"
              ItemsSource="{Binding LinearTrades}"
              SelectedItem="{Binding SelectedLinearTrade, Mode=TwoWay}"

              ColumnHeaderStyle="{StaticResource Style.BlotterDataGridHeader}"
              CellStyle="{StaticResource Style.BlotterDataGridCell}"
              RowStyle="{StaticResource Style.BlotterDataGridRow.Linear}"
AutoGenerateColumns="False">


                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="TradeID" Binding="{Binding TradeId}" Width="120"/>
                                        <DataGridTextColumn Header="Counterpart" Binding="{Binding Counterparty}" Width="100"/>
                                        <DataGridTextColumn Header="Ccy Pair" Binding="{Binding CcyPair}" Width="80"/>
                                        <DataGridTextColumn Header="Buy/Sell" Binding="{Binding BuySell}" Width="70"/>
                                        <DataGridTextColumn Header="Notional" Binding="{Binding Notional, StringFormat=N0}" Width="110"/>
                                        <DataGridTextColumn Header="Notional Ccy" Binding="{Binding NotionalCcy}" Width="90"/>
                                        <DataGridTextColumn Header="Hedge Rate" Binding="{Binding HedgeRate, StringFormat=F4}" Width="90"/>
                                        <DataGridTextColumn Header="Hedge Type" Binding="{Binding HedgeType}" Width="90"/>
                                        <DataGridTextColumn Header="Settlement Date" Binding="{Binding SettlementDate, StringFormat=yyyy-MM-dd}" Width="110"/>
                                        <DataGridTextColumn Header="Book Calypso" Binding="{Binding CalypsoPortfolio}" Width="110"/>
                                        <DataGridTextColumn Header="Book MX3" Binding="{Binding PortfolioMx3}" Width="110"/>
                                        <DataGridTextColumn Header="Trader" Binding="{Binding Trader}" Width="80"/>
                                        <DataGridTemplateColumn Header="Status" Width="180" CellTemplate="{StaticResource StatusPillTemplate}" />
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>






                            <!-- Column separator -->
                            <Border Grid.Column="1" Background="{StaticResource Brush.BorderSoft}"/>

                            
                            
                            
                            
                            <!-- RIGHT: Detail -->
                            <Border Grid.Column="2"
        Background="Transparent"
        Padding="12">

                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <!-- Tabs -->
                                    <Border Style="{StaticResource Style.BlotterTabContainer}">

                                        <StackPanel Orientation="Horizontal">

                                            <RadioButton x:Name="TabSummary"
                             GroupName="DetailTabs"
                             IsChecked="True"
                             Style="{StaticResource DetailTabRadioStyle}"
                             Content="Summary"/>

                                            <RadioButton x:Name="TabEconomics"
                             GroupName="DetailTabs"
                             Style="{StaticResource DetailTabRadioStyle}"
                             Content="Economics"/>

                                            <RadioButton x:Name="TabRouting"
                             GroupName="DetailTabs"
                             Style="{StaticResource DetailTabRadioStyle}"
                             Content="Routing"/>

                                            <RadioButton x:Name="TabRaw"
                             GroupName="DetailTabs"
                             Style="{StaticResource DetailTabRadioStyle}"
                             Content="Raw"/>
                                            
                                        </StackPanel>
                                    </Border>

                                    <!-- Pages -->
                                    <Grid Grid.Row="1" Margin="0,12,0,0">

                                        <!-- SUMMARY PAGE -->
                                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                                            <ScrollViewer.Style>
                                                <Style TargetType="{x:Type ScrollViewer}">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsChecked, ElementName=TabSummary}" Value="True">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </ScrollViewer.Style>

                                            <StackPanel>

                                                <!-- TRADE SUMMARY card -->
                                                <Border Style="{StaticResource Style.BlotterRightCard}">
                                                    <StackPanel>
                                                        <TextBlock Text="TRADE SUMMARY" Style="{StaticResource Style.BlotterRightSectionTitle}"/>

                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="120"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>

                                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="TradeId" Style="{StaticResource Style.BlotterRightKey}"/>
                                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="TRD-000128" Style="{StaticResource Style.BlotterRightValue}"/>

                                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Source" Style="{StaticResource Style.BlotterRightKey}"/>
                                                            <TextBlock Grid.Row="1" Grid.Column="1" Text="VOLBROKER / AE" Style="{StaticResource Style.BlotterRightValue}"/>

                                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="MessageKey" Style="{StaticResource Style.BlotterRightKey}"/>
                                                            <TextBlock Grid.Row="2" Grid.Column="1" Text="571=704955891.0.05" Style="{StaticResource Style.BlotterRightValue}"/>

                                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Instrument" Style="{StaticResource Style.BlotterRightKey}"/>
                                                            <TextBlock Grid.Row="3" Grid.Column="1" Text="USDJPY" Style="{StaticResource Style.BlotterRightValue}"/>

                                                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Product" Style="{StaticResource Style.BlotterRightKey}"/>
                                                            <TextBlock Grid.Row="4" Grid.Column="1" Text="OPTION_VANILLA" Style="{StaticResource Style.BlotterRightValue}"/>

                                                            <TextBlock Grid.Row="5" Grid.Column="0" Text="Side" Style="{StaticResource Style.BlotterRightKey}"/>
                                                            <TextBlock Grid.Row="5" Grid.Column="1" Text="Buy" Style="{StaticResource Style.BlotterRightValue}"/>

                                                            <TextBlock Grid.Row="6" Grid.Column="0" Text="Notional" Style="{StaticResource Style.BlotterRightKey}"/>
                                                            <TextBlock Grid.Row="6" Grid.Column="1" Text="25,000,000" Style="{StaticResource Style.BlotterRightValue}"/>

                                                            <TextBlock Grid.Row="7" Grid.Column="0" Text="Price" Style="{StaticResource Style.BlotterRightKey}"/>
                                                            <TextBlock Grid.Row="7" Grid.Column="1" Text="155.2300" Style="{StaticResource Style.BlotterRightValue}"/>

                                                            <TextBlock Grid.Row="8" Grid.Column="0" Text="TradeTime" Style="{StaticResource Style.BlotterRightKey}"/>
                                                            <TextBlock Grid.Row="8" Grid.Column="1" Text="2025-12-12 14:31:09" Style="{StaticResource Style.BlotterRightValue}"/>
                                                        </Grid>
                                                    </StackPanel>
                                                </Border>

                                                <!-- WORKFLOW card -->
                                                <Border Style="{StaticResource Style.BlotterRightCard}">
                                                    <StackPanel>
                                                        <TextBlock Text="WORKFLOW" Style="{StaticResource Style.BlotterRightSectionTitle}"/>

                                                        <WrapPanel>
                                                            <Border Style="{StaticResource Style.BlotterChip}">
                                                                <TextBlock Text="Ingested" Style="{StaticResource Style.BlotterChipText}"/>
                                                            </Border>
                                                            <Border Style="{StaticResource Style.BlotterChip}">
                                                                <TextBlock Text="Normalized" Style="{StaticResource Style.BlotterChipText}"/>
                                                            </Border>
                                                            <Border Style="{StaticResource Style.BlotterChip}">
                                                                <TextBlock Text="MX3 link: pending" Style="{StaticResource Style.BlotterChipText}"/>
                                                            </Border>
                                                            <Border Style="{StaticResource Style.BlotterChip}">
                                                                <TextBlock Text="Audit: 4 events" Style="{StaticResource Style.BlotterChipText}"/>
                                                            </Border>
                                                        </WrapPanel>

                                                        <TextBlock Margin="0,6,0,0"
                               Foreground="{StaticResource Brush.TextMuted}"
                               Text="TODO: I v2 kan vi lägga busy state/spinner på Refresh/Book."/>
                                                    </StackPanel>
                                                </Border>

                                            </StackPanel>
                                        </ScrollViewer>

                                        <!-- ECONOMICS PAGE -->
                                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                                            <ScrollViewer.Style>
                                                <Style TargetType="{x:Type ScrollViewer}">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsChecked, ElementName=TabEconomics}" Value="True">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </ScrollViewer.Style>

                                            <StackPanel>
                                                <Border Style="{StaticResource Style.BlotterRightCard}">
                                                    <StackPanel>
                                                        <TextBlock Text="ECONOMICS" Style="{StaticResource Style.BlotterRightSectionTitle}"/>

                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="120"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>

                                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="CcyPair" Style="{StaticResource Style.BlotterRightKey}"/>
                                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="USDJPY" Style="{StaticResource Style.BlotterRightValue}"/>

                                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="SettleCcy" Style="{StaticResource Style.BlotterRightKey}"/>
                                                            <TextBlock Grid.Row="1" Grid.Column="1" Text="JPY" Style="{StaticResource Style.BlotterRightValue}"/>

                                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="ValueDate" Style="{StaticResource Style.BlotterRightKey}"/>
                                                            <TextBlock Grid.Row="2" Grid.Column="1" Text="2025-12-16" Style="{StaticResource Style.BlotterRightValue}"/>

                                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Strike" Style="{StaticResource Style.BlotterRightKey}"/>
                                                            <TextBlock Grid.Row="3" Grid.Column="1" Text="—" Style="{StaticResource Style.BlotterRightValue}"/>

                                                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Expiry" Style="{StaticResource Style.BlotterRightKey}"/>
                                                            <TextBlock Grid.Row="4" Grid.Column="1" Text="—" Style="{StaticResource Style.BlotterRightValue}"/>
                                                        </Grid>

                                                        <TextBlock Margin="0,10,0,0"
                               Foreground="{StaticResource Brush.TextMuted}"
                               Text="Idé: Här visar du allt som annars skulle bli 40+ kolumner i gridet."/>
                                                    </StackPanel>
                                                </Border>
                                            </StackPanel>
                                        </ScrollViewer>

                                        <!-- ROUTING PAGE -->
                                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                                            <ScrollViewer.Style>
                                                <Style TargetType="{x:Type ScrollViewer}">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsChecked, ElementName=TabRouting}" Value="True">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </ScrollViewer.Style>

                                            <StackPanel>

                                                <Border Style="{StaticResource Style.BlotterRightCard}">
                                                    <StackPanel>
                                                        <TextBlock Text="ROUTING / LINKS" Style="{StaticResource Style.BlotterRightSectionTitle}"/>

                                                        <!-- MX3 System -->
                                                        <Border Style="{StaticResource Style.BlotterSystemCard}">
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="*"/>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                </Grid.ColumnDefinitions>
                                                                <Grid.RowDefinitions>
                                                                    <RowDefinition Height="Auto"/>
                                                                    <RowDefinition Height="Auto"/>
                                                                    <RowDefinition Height="Auto"/>
                                                                </Grid.RowDefinitions>

                                                                <!-- System name -->
                                                                <TextBlock Grid.Row="0" Grid.Column="0" 
                                   Text="MX3" 
                                   Style="{StaticResource Style.BlotterSystemName}"/>

                                                                <!-- Status badge -->
                                                                <Border Grid.Row="0" Grid.Column="1" Grid.RowSpan="2"
                                Style="{StaticResource Style.BlotterStatusBadge}"
                                Margin="0,0,0,0">
                                                                    <StackPanel Orientation="Horizontal">
                                                                        <Ellipse Width="6" Height="6" 
                                         Fill="#FBBF24" 
                                         Margin="0,0,6,0"
                                         VerticalAlignment="Center"/>
                                                                        <TextBlock Text="Pending" 
                                           Style="{StaticResource Style.BlotterStatusBadgeText}"/>
                                                                    </StackPanel>
                                                                </Border>

                                                                <!-- System code -->
                                                                <TextBlock Grid.Row="1" Grid.Column="0"
                                   Text="SystemCode=MX3" 
                                   Style="{StaticResource Style.BlotterSystemCode}"/>

                                                                <!-- External info & button -->
                                                                <Grid Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,8,0,0">
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                        <ColumnDefinition Width="*"/>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                    </Grid.ColumnDefinitions>

                                                                    <TextBlock Grid.Column="0"
                                       Text="External:" 
                                       Foreground="{StaticResource Brush.TextMuted2}"
                                       FontSize="11"
                                       Margin="0,0,6,0"
                                       VerticalAlignment="Center"/>

                                                                    <TextBlock Grid.Column="1"
                                       Text="—" 
                                       Foreground="{StaticResource Brush.TextMuted}"
                                       FontSize="11"
                                       VerticalAlignment="Center"/>

                                                                    <Button Grid.Column="2"
                                    Content="Retry"
                                    Style="{StaticResource Style.BlotterActionButton}"/>
                                                                </Grid>
                                                            </Grid>
                                                        </Border>


                                                        <!-- CALYPSO System -->
                                                        <Border Style="{StaticResource Style.BlotterSystemCard}">
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="*"/>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                </Grid.ColumnDefinitions>
                                                                <Grid.RowDefinitions>
                                                                    <RowDefinition Height="Auto"/>
                                                                    <RowDefinition Height="Auto"/>
                                                                    <RowDefinition Height="Auto"/>
                                                                </Grid.RowDefinitions>

                                                                <TextBlock Grid.Row="0" Grid.Column="0" 
                                   Text="CALYPSO" 
                                   Style="{StaticResource Style.BlotterSystemName}"/>

                                                                <Border Grid.Row="0" Grid.Column="1" Grid.RowSpan="2"
                                Style="{StaticResource Style.BlotterStatusBadge}">
                                                                    <StackPanel Orientation="Horizontal">
                                                                        <Ellipse Width="6" Height="6" 
                                         Fill="{StaticResource Brush.TextMuted}" 
                                         Margin="0,0,6,0"
                                         VerticalAlignment="Center"/>
                                                                        <TextBlock Text="Not linked" 
                                           Style="{StaticResource Style.BlotterStatusBadgeText}"/>
                                                                    </StackPanel>
                                                                </Border>

                                                                <TextBlock Grid.Row="1" Grid.Column="0"
                                   Text="SystemCode=CALYPSO" 
                                   Style="{StaticResource Style.BlotterSystemCode}"/>

                                                                <Grid Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,8,0,0">
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                        <ColumnDefinition Width="*"/>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                    </Grid.ColumnDefinitions>

                                                                    <TextBlock Grid.Column="0"
                                       Text="External:" 
                                       Foreground="{StaticResource Brush.TextMuted2}"
                                       FontSize="11"
                                       Margin="0,0,6,0"
                                       VerticalAlignment="Center"/>

                                                                    <TextBlock Grid.Column="1"
                                       Text="—" 
                                       Foreground="{StaticResource Brush.TextMuted}"
                                       FontSize="11"
                                       VerticalAlignment="Center"/>

                                                                    <Button Grid.Column="2"
                                    Content="Create link"
                                    Style="{StaticResource Style.BlotterActionButton}"/>
                                                                </Grid>
                                                            </Grid>
                                                        </Border>

                                                        <!-- LATEST WORKFLOW EVENTS card -->
                                                        <Border Style="{StaticResource Style.BlotterRightCard}">
                                                            <StackPanel>
                                                                <TextBlock Text="LATEST WORKFLOW EVENTS" Style="{StaticResource Style.BlotterRightSectionTitle}"/>

                                                                <!-- Event 1 -->
                                                                <Border Style="{StaticResource Style.BlotterEventRow}">
                                                                    <Grid>
                                                                        <Grid.ColumnDefinitions>
                                                                            <ColumnDefinition Width="Auto"/>
                                                                            <ColumnDefinition Width="*"/>
                                                                        </Grid.ColumnDefinitions>

                                                                        <TextBlock Grid.Column="0"
                                   Text="14:31:09" 
                                   Style="{StaticResource Style.BlotterEventTime}"/>

                                                                        <StackPanel Grid.Column="1">
                                                                            <TextBlock Text="MessageIn.Inserted" 
                                       Style="{StaticResource Style.BlotterEventTitle}"/>
                                                                            <TextBlock Text="Source=VOLBROKER • MsgType=AE • SeqNum=17" 
                                       Style="{StaticResource Style.BlotterEventBody}"/>
                                                                        </StackPanel>
                                                                    </Grid>
                                                                </Border>

                                                                <!-- Event 2 -->
                                                                <Border Style="{StaticResource Style.BlotterEventRow}">
                                                                    <Grid>
                                                                        <Grid.ColumnDefinitions>
                                                                            <ColumnDefinition Width="Auto"/>
                                                                            <ColumnDefinition Width="*"/>
                                                                        </Grid.ColumnDefinitions>

                                                                        <TextBlock Grid.Column="0"
                                   Text="14:31:09" 
                                   Style="{StaticResource Style.BlotterEventTime}"/>

                                                                        <StackPanel Grid.Column="1">
                                                                            <TextBlock Text="Trade.Normalized" 
                                       Style="{StaticResource Style.BlotterEventTitle}"/>
                                                                            <TextBlock Text="ProductType=OPTION_VANILLA • Instrument=USDJPY" 
                                       Style="{StaticResource Style.BlotterEventBody}"/>
                                                                        </StackPanel>
                                                                    </Grid>
                                                                </Border>

                                                                <!-- Event 3 -->
                                                                <Border Style="{StaticResource Style.BlotterEventRow}">
                                                                    <Grid>
                                                                        <Grid.ColumnDefinitions>
                                                                            <ColumnDefinition Width="Auto"/>
                                                                            <ColumnDefinition Width="*"/>
                                                                        </Grid.ColumnDefinitions>

                                                                        <TextBlock Grid.Column="0"
                                   Text="14:31:10" 
                                   Style="{StaticResource Style.BlotterEventTime}"/>

                                                                        <StackPanel Grid.Column="1">
                                                                            <TextBlock Text="TradeSystemLink.Created" 
                                       Style="{StaticResource Style.BlotterEventTitle}"/>
                                                                            <TextBlock Text="SystemCode=MX3 • Status=Pending" 
                                       Style="{StaticResource Style.BlotterEventBody}"/>
                                                                        </StackPanel>
                                                                    </Grid>
                                                                </Border>

                                                            </StackPanel>
                                                        </Border>


                                                        <!-- Note -->
                                                        <TextBlock Foreground="{StaticResource Brush.TextMuted2}"
                                                                   FontSize="11"
                                                                   TextWrapping="Wrap"
                                                                   Text="Not: Sen kan VolbrokerAckStatus + VolbrokerExternalTradeId visas här."/>
                                                    </StackPanel>
                                                </Border>

                                            </StackPanel>
                                        </ScrollViewer>

                                        <!-- RAW PAGE -->
                                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                                            <ScrollViewer.Style>
                                                <Style TargetType="{x:Type ScrollViewer}">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsChecked, ElementName=TabRaw}" Value="True">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </ScrollViewer.Style>

                                            <StackPanel>

                                                <Border Style="{StaticResource Style.BlotterRightCard}">
                                                    <StackPanel>
                                                        <TextBlock Text="DIAGNOSTICS" Style="{StaticResource Style.BlotterRightSectionTitle}"/>
                                                        <TextBlock Foreground="{StaticResource Brush.TextMuted}"
                               Text="Diagnostics fields här (RawHash, SeqNum, SessionKey...)."/>
                                                    </StackPanel>
                                                </Border>

                                                <Border Style="{StaticResource Style.BlotterRightCard}">
                                                    <StackPanel>
                                                        <TextBlock Text="RAW" Style="{StaticResource Style.BlotterRightSectionTitle}"/>
                                                        <TextBlock Foreground="{StaticResource Brush.TextMuted}"
                               Text="Raw payload box + Copy raw/Copy JSON/Re-parse knappar här."/>
                                                    </StackPanel>
                                                </Border>

                                            </StackPanel>
                                        </ScrollViewer>

                                    </Grid>


                                </Grid>
                            </Border>



                        </Grid>

                    </Grid>
                </Border>

            </Grid>
        </Border>

    </Grid>
</UserControl>
